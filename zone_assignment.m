% AC adjacency matrix between buses
A = [0 1 1 0 0 0 0 0 0 0 0;...
    1 0 0 1 0 0 0 0 0 0 0;...
    1 0 0 1 1 0 0 0 0 0 0;...
    0 1 1 0 1 0 0 0 0 0 0;...
    0 0 1 1 0 0 0 0 0 0 0;...
    0 0 0 0 0 0 1 0 1 0 0;...
    0 0 0 0 0 1 0 1 0 0 0;...
    0 0 0 0 0 0 1 0 1 0 0;...
    0 0 0 0 0 1 0 1 0 0 0;...
    0 0 0 0 0 0 0 0 0 0 1;...
    0 0 0 0 0 0 0 0 0 1 0];
% Incidence matrix from converters to buses
B = [0 1 0 0 0 0 0 0 0 0 0;...
    0 0 0 1 0 0 0 0 0 0 0;...
    0 0 0 0 0 1 0 0 0 0 0;...
    0 0 0 0 1 0 0 0 0 0 0;...
    0 0 0 0 0 0 0 0 0 1 0;...
    0 0 0 0 0 0 0 0 1 0 0];
% Buses connected to synchronous generators
S = [1 8];
% DC Adjacency matrix between converters
D = [0 0 1 0 0 0;0 0 1 0 0 0;1 1 0 0 0 0;...
    0 0 0 0 1 1;0 0 0 1 0 1;0 0 0 1 1 0];

%% AC zones
comps = connected_components(A);
nu = mapping_AC(comps);

AC_zones_t = compute_AC_zones(B,comps);

Snu = S;
for i=1:length(Snu)
    Snu(i) = nu(S(i));
end
id_SG = unique(Snu);
id_Total = 1:length(AC_zones_t);
id_NSG = id_Total(~ismember(id_Total, id_SG));

AC_zones_NSG = {};
for k=1:length(id_NSG)
    AC_zones_NSG{k} = AC_zones_t{id_NSG(k)};
end

%% DC zones
DC_zones = connected_components(D);